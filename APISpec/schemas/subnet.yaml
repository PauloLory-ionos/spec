Subnet:
  type: object
  description: |
    A Subnet represents a logical subdivision of a LAN's IP address space.
    
    Key Network Routing Concepts:
    - Defines a range of IP addresses for compute instances
    - Supports custom default gateway configuration
    - Enables network segmentation and isolation
    
    Default Gateway Behavior:
    - 'auto': Automatically selects the first usable IP in the subnet range
    - Custom configuration allows routing through specific instances or IPs
    - Useful for implementing advanced network topologies like:
      * Application-level firewalls
      * Custom routing through network appliances
      * Multi-tier network architectures
  
  properties:
    apiVersion:
      type: string
      description: API version of the resource
      default: v1beta1
      readOnly: true
    kind:
      type: string
      description: Type of the resource
      enum: [ subnet ]
      readOnly: true
    metadata:
      $ref: './resource.yaml#/ZonalResourceMetadata'
    spec:
      type: object
      properties:
        profile:
          type: object
          properties:
            networkSkuRef:
              type: string
              description: |
                Reference to a network SKU defining bandwidth performance.
                Allows selection of network performance tier.
                Pattern: '^seca\.(10|100|1000)$'
        cidr:
          type: object
          properties:
            ipv4Range:
              type: string
              format: ipv4
              description: |
                IPv4 address range for the subnet.
                Must be unique within the LAN and cannot be modified after creation.
                Example: '192.168.1.0/24'
        dhcpEnabled:
          type: boolean
          enum: [true]
          default: true
          description: "for now we allow only dhcp enabled"
        defaultGateway:
          type: object
          description: |
            Configuration for the subnet's default gateway.
            Provides flexibility in routing traffic.
          properties:
            type:
              type: string
              enum: ['auto', 'instanceRef', 'internalIp']
              default: 'auto'
            value:
              type: string
              description: |
                - For 'instanceRef': Name of the compute instance acting as gateway
                - For 'internalIp': Specific IP address to use as gateway
    
    status:
      type: object
      readOnly: true
      properties:
        state:
          $ref: './resource.yaml#/ResourceState'
        ipv4Range:
          type: string
          format: CIDR
        zone:
          type: string
        defaultGateway:
          type: object
          description: Actual default gateway configuration
          properties:
            type:
              type: string
              enum: ['auto', 'instanceRef', 'internalIp']
            value:
              type: string
        conditions:
          $ref: "./resource.yaml#/StatusConditions"
  
  example:
    - description: Standard subnet with auto gateway
      value:
        apiVersion: v1beta1
        kind: subnet
        metadata:
          name: standard-subnet
        spec:
          ipv4Range: '192.168.1.0/24'
          networkSkuRef: 'seca.100'
          dhcpEnabled: true
    
    - description: Custom gateway through network appliance
      value:
        apiVersion: v1beta1
        kind: subnet
        metadata:
          name: firewall-subnet
        spec:
          ipv4Range: '10.0.0.0/24'
          dhcpEnabled: true
          defaultGateway:
            type: instanceRef
            value: 'network-firewall-01'
