ResourceMetadata:
  type: object
  properties:
    name:
      type: string
    labels:
      type: array
      items:
        $ref: '#/Label'

Label:
  type: object
  properties:
    key:
      type: string
    value:
      type: string

Profile:
  type: object
  properties:
    name:
      type: string
    labels:
      type: array
      items:
        $ref: '#/Label'
    privateSettings:
      type: array
      items:
        $ref: '#/Setting'
    protectedSettings:
      type: array
      items:
        $ref: '#/Setting'
    publicSettings:
      type: array
      items:
        $ref: '#/Setting'
    parentRef:
      type: object
      properties:
        type:
          type: string
          enum: [ "Profile" ]
        name:
          type: string

Setting:
  type: object
  properties:
    name:
      type: string
    value:
      type: string
    constraints:
      type: array
      items:
        $ref: '#/Constraint'

Constraint:
  type: object
  properties:
    type:
      type: string
      enum: ['MIN', 'MAX', 'LIST', 'REGEX', 'RANGE', 'LENGTH', 'ENUM', 'CHARSET', 'DATE_FORMAT', 'EMAIL', 'URL', 'PRECISION', 'MULTIPLE_OF']
    value:
      oneOf:
        - type: string  # For MIN, MAX, REGEX, LIST, ENUM, CHARSET, DATE_FORMAT, EMAIL, URL
        - type: array   # For LIST, ENUM
          items:
            type: string
        - type: object  # For RANGE, LENGTH, PRECISION
          properties:
            min:
              type: number
            max:
              type: number
        - type: number  # For MULTIPLE_OF
  required:
    - type
    - value

Connector:
  type: object
  properties:
    id:
      type: string
    name:
      type: string
    sourceResource:
      $ref: '#/ResourceMetadata'
    targetResource:
      $ref: '#/ResourceMetadata'

ServerProfile:
  type: object
  properties:
    metadata:
      $ref: '#/ResourceMetadata'
    spec:
      type: object
      properties:
        cpuType:
          type: string
        cores:
          type: integer
          minimum: 1
        ramGB:
          type: number
          multipleOf: 0.25
      required:
        - cpuType
        - cores
        - ramGB
    status:
      type: object
      properties:
        state:
          type: string
          enum: ['available', 'unavailable']

VolumeProfile:
  type: object
  properties:
    metadata:
      $ref: '#/ResourceMetadata'
    spec:
      type: object
      properties:
        IOPs:
          type: integer
          minimum: 1
      required:
        - IOPs
    status:
      type: object
      properties:
        state:
          type: string
          enum: ['available', 'unavailable']

region:
  type: object
  properties:
    name:
      type: string
    availableZones:
      type: array
      items:
        type: string
