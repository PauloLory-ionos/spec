ResourceMetadata:
  type: object
  description: Represents metadata for a resource, including identifying information and classification through labels and annotations
  properties:
    name:
      type: string
      description: Resource identifier in dash-case (kebab-case) format. Must start and end with an alphanumeric character. Can contain lowercase letters, numbers, and hyphens. Multiple segments can be joined with dots. Each segment follows the same rules.
      minLength: 1
      maxLength: 128
      pattern: '^[a-z0-9]([-a-z0-9]*[a-z0-9])?(\.[a-z0-9]([-a-z0-9]*[a-z0-9])?)*$'
      examples:
        - primary-load-balancer
        - vpc-east-1
        - db.postgres-13-main
        - compute.instance-pool-web
    labels:
      type: array
      description: User-defined key/value pairs that are mutable and can be used to organize and categorize resources.
      items:
        $ref: '#/Label'
      example:
        - key: cloud:region
          value: us-east-1
        - key: billing.cost-center
          value: platform-eng
        - key: tier
          value: production
    annotations:
      type: array
      readOnly: true
      description: System-managed key/value pairs that store non-identifying metadata about the resource. Annotations are used by system components.
      items:
        $ref: '#/Label'
      example:
        - key: provisioning.timestamp
          value: "2024-10-30T15:00:00Z"
        - key: last.modified.by
          value: "terraform-controller"

Label:
  type: object
  description: Represents a key/value pair used for both labels and annotations, providing a consistent structure for metadata tagging
  properties:
    key:
      type: string
      description: The identifier for the label or annotation. Keys can be optionally namespaced using either a colon or dot notation (e.g., 'monitoring:alert-level' or 'monitoring.alert-level'). The namespace portion follows the same naming rules as the key.
      minLength: 1
      maxLength: 63
      pattern: '^([a-z0-9A-Z][-a-z0-9A-Z_.]*)?[a-z0-9A-Z]$'
    value:
      type: string
      description: The data content of the label or annotation. For labels, must be 63 characters or less. For annotations, can contain more extensive data.
      maxLength: 63
  required:
    - key
    - value

Profile:
  type: object
  properties:
    name:
      type: string
    labels:
      type: array
      items:
        $ref: '#/Label'
    privateSettings:
      type: array
      items:
        $ref: '#/Setting'
    protectedSettings:
      type: array
      items:
        $ref: '#/Setting'
    publicSettings:
      type: array
      items:
        $ref: '#/Setting'
    parentRef:
      type: object
      properties:
        type:
          type: string
          enum: [ "Profile" ]
        name:
          type: string

Setting:
  type: object
  properties:
    name:
      type: string
    value:
      type: string
    constraints:
      type: array
      items:
        $ref: '#/Constraint'

Constraint:
  type: object
  properties:
    type:
      type: string
      enum: ['MIN', 'MAX', 'LIST', 'REGEX', 'RANGE', 'LENGTH', 'ENUM', 'CHARSET', 'DATE_FORMAT', 'EMAIL', 'URL', 'PRECISION', 'MULTIPLE_OF']
    value:
      oneOf:
        - type: string  # For MIN, MAX, REGEX, LIST, ENUM, CHARSET, DATE_FORMAT, EMAIL, URL
        - type: array   # For LIST, ENUM
          items:
            type: string
        - type: object  # For RANGE, LENGTH, PRECISION
          properties:
            min:
              type: number
            max:
              type: number
        - type: number  # For MULTIPLE_OF
  required:
    - type
    - value

Connector:
  type: object
  properties:
    id:
      type: string
    name:
      type: string
    sourceResource:
      $ref: '#/ResourceMetadata'
    targetResource:
      $ref: '#/ResourceMetadata'

ServerProfile:
  type: object
  properties:
    metadata:
      $ref: '#/ResourceMetadata'
    spec:
      type: object
      properties:
        cpuType:
          type: string
        cores:
          type: integer
          minimum: 1
        ramGB:
          type: number
          multipleOf: 0.25
      required:
        - cpuType
        - cores
        - ramGB
    status:
      type: object
      properties:
        state:
          type: string
          enum: ['available', 'unavailable']

VolumeProfile:
  type: object
  properties:
    metadata:
      $ref: '#/ResourceMetadata'
    spec:
      type: object
      properties:
        IOPs:
          type: integer
          minimum: 1
      required:
        - IOPs
    status:
      type: object
      properties:
        state:
          type: string
          enum: ['available', 'unavailable']

region:
  type: object
  properties:
    name:
      type: string
    availableZones:
      type: array
      items:
        type: string