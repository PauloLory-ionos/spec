Instance:
  type: object
  properties:
    apiVersion:
      type: string
      description: API version of the resource
      default: v1alpha1
      readOnly: true
    kind:
      type: string
      description: Type of the resource
      enum: [ instance ]
      readOnly: true
    metadata:
      $ref: './resource.yaml#/ZonalResourceMetadata'
    spec:
      type: object
      properties:
        profile:
          type: object
          properties:
            instanceSkuRef:
              type: string
              description: Reference to the SKU used for this instance
            skuExtentions:
              type: array
              items:
                type: object
                properties:
                  key:
                    type: string
                  value:
                    type: string
        network:
          type: object
          properties:
            primaryNicRef:
              type: string
              description: Reference to the primary NIC for this instance
            otherNics:
              type: array
              description: Additional NICs attached to this instance
              items:
                type: object
                properties:
                  nicRef:
                    type: string
                    description: Reference to the NIC
                  slot:
                    type: integer
                    description: Slot number for the NIC
        operatingSystem:
          type: object
          properties:
            cloudInitData:
              type: object
              properties:
                userData:
                  type: string
                  description: |
                    Cloud-init user data for instance initialization
                    Example cloud-init user configuration with SSH key:
                    ```yaml
                    #cloud-config
                    packages:
                      - nginx
                    ```
                sshKeyExternalRef:
                  type: array
                  items:
                    type: string
                    example: 'ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQC0g...'
                  description: |
                    Provider-specific references to SSH keys used in cloud-init vendorData.
                    These references are used to inject SSH public keys during instance initialization 
                    through cloud-init's vendor data configuration.
            osBlockStorageRef:
              $ref: './resource.yaml#/VolumeAttachment'
        storage:
          type: object
          properties:
            dataBlockStorageRef:
              type: array
              items:
                $ref: './resource.yaml#/VolumeAttachment'

    status:
      type: object
      readOnly: true
      properties:
        state:
          $ref: './resource.yaml#/ResourceState'
        placement:
          type: object
          properties:
            strategy:
              type: string
              enum: ['zone', 'auto', 'anti-affinity']
            zone:
              type: string
            antiAffinityGroup:
              type: string
        network:
          type: object
          properties:
            primaryNicRef:
              type: string
            otherNics:
              type: array
              items:
                type: object
                properties:
                  nicRef:
                    type: string
                  slot:
                    type: integer
        dataBlockStorageRef:
          type: array
          items:
            type: string
        conditions:
          example:
            - type: "power"
              status: "on"
              lastTransitionTime: "2024-11-21T14:39:22Z"
              reason: "user_request"
              message: "executed successfully"
          allOf:
            - type: array
              items:
                type: object
                enum:
                  - type: "power"
                    status: "on"
                    lastTransitionTime: "2024-11-21T14:39:22Z"
                    reason: "user_request"
                    message: "executed successfully"
            - $ref: "./resource.yaml#/StatusConditions"
